/* ============= CORREÇÃO MASTER DE Z-INDEX PARA DROPDOWNS ============= */
/* SOLUÇÃO DEFINITIVA PARA PROBLEMAS DE SOBREPOSIÇÃO */

/* 
HIERARQUIA DE Z-INDEX PADRONIZADA:
- Background/decorativo: -1 a 10
- Conteúdo normal: 10 a 100 
- Headers/títulos: 100 a 500
- Modais base: 1000 a 5000
- Dropdowns: 10000 a 50000
- Notificações/alertas: 50000+
*/

/* ============= RESET DE Z-INDEX PROBLEMÁTICOS ============= */

/* Títulos de gráficos - reduzir z-index para não interferir */
.chart-card h3,
.chart-title,
.chart-card h4,
.section-header h3,
.section-header h4 {
    z-index: 1 !important;
    position: relative;
}

/* Containers de análise */
.analysis-section,
.chart-card,
.kpi-card {
    z-index: 1 !important;
    position: relative;
}

/* ============= DROPDOWNS DE FILTRO - SISTEMA UNIFICADO ============= */

/* Container principal dos filtros */
.infra-filters-container {
    position: relative;
    z-index: 5000 !important;
}

.filters-grid {
    position: relative;
    z-index: 5001 !important;
}

/* Cada grupo de filtro */
.filter-group {
    position: relative !important;
    z-index: 5002 !important;
}

/* Select múltiplo - estado normal */
.filter-group select[multiple] {
    position: relative;
    z-index: 5003;
}

/* Select múltiplo - estado ativo/focus - MÁXIMA PRIORIDADE */
.filter-group select[multiple]:focus {
    position: relative !important;
    z-index: 99999 !important;
    box-shadow: 0 25px 75px rgba(0, 0, 0, 0.4) !important;
    border: 3px solid #3b82f6 !important;
    background: white !important;
    border-radius: 8px !important;
}

/* ============= CHECKBOX DROPDOWN SYSTEM ============= */

.checkbox-dropdown {
    position: relative !important;
    z-index: 5003 !important;
}

.checkbox-dropdown.open {
    z-index: 99998 !important;
}

.checkbox-dropdown-content {
    position: absolute !important;
    z-index: 99999 !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    background: white !important;
    border: 2px solid #3b82f6 !important;
    border-radius: 8px !important;
    box-shadow: 0 25px 75px rgba(0, 0, 0, 0.4) !important;
    max-height: 300px !important;
    overflow-y: auto !important;
    margin-top: 2px !important;
}

.checkbox-dropdown.open .checkbox-dropdown-content {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* ============= USER DROPDOWN - COMPATIBILIDADE ============= */

.user-dropdown-menu {
    z-index: 10000 !important;
}

/* ============= MODAIS - GARANTIR QUE FIQUEM ACIMA ============= */

.modal {
    z-index: 50000 !important;
}

.modal-content {
    z-index: 50001 !important;
}

/* ============= NOTIFICAÇÕES E ALERTAS ============= */

.notification,
.alert,
.toast {
    z-index: 60000 !important;
}

/* ============= MODO DARK - COMPATIBILIDADE ============= */

.dark-mode .filter-group select[multiple]:focus {
    background: #1f2937 !important;
    border-color: #4f46e5 !important;
    color: #f9fafb !important;
}

.dark-mode .checkbox-dropdown-content {
    background: #1f2937 !important;
    border-color: #4f46e5 !important;
    color: #f9fafb !important;
}

/* ============= RESPONSIVE - MOBILE COMPATIBILITY ============= */

@media (max-width: 768px) {
    .filter-group select[multiple]:focus {
        position: relative !important;
        width: 100% !important;
        max-height: 200px !important;
        z-index: 99999 !important;
    }
}

/* ============= DEBUG - REMOVER EM PRODUÇÃO ============= */
/*
.filter-group select[multiple]:focus::before {
    content: "Z-INDEX: 99999";
    position: absolute;
    top: -30px;
    left: 0;
    background: red;
    color: white;
    padding: 5px;
    font-size: 12px;
    z-index: 100000;
}
*/

/* ============= GARANTIR FUNCIONAMENTO ============= */

/* Override de qualquer z-index conflitante */
body .filter-group select[multiple]:focus {
    z-index: 99999 !important;
    position: relative !important;
}

body .checkbox-dropdown.open .checkbox-dropdown-content {
    z-index: 99999 !important;
}