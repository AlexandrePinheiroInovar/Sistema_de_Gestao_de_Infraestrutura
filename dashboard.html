<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de An√°lises - Dashboard</title>
    <link rel="stylesheet" href="src/css/styles.css?v=1.3&t=2025081813">
    <link rel="stylesheet" href="src/css/checkbox-dropdown.css?v=1.3&t=2025081813">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="src/assets/images/Inovar-Telecom-Logo-Site_.png">
</head>
<body>
    <!-- Modal de Notifica√ß√£o Personalizado -->
    <div id="customNotification" class="custom-notification">
        <div class="notification-content">
            <div class="notification-icon">
                <span id="notificationIcon">‚úÖ</span>
            </div>
            <div class="notification-body">
                <h3 id="notificationTitle">Sucesso!</h3>
                <p id="notificationMessage">Opera√ß√£o realizada com sucesso.</p>
            </div>
            <div class="notification-actions">
                <button id="notificationConfirm" class="btn-confirm">OK</button>
                <button id="notificationCancel" class="btn-cancel" style="display: none;">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="dashboard-container">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
        
                <div class="sidebar-logo">
                    <img src="src/assets/images/Inovar-Telecom-Logo-Site_.png" alt="Logo Inovar Telecom" style="max-width: 150px; display: block; margin: 0 auto;">
                </div>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" onclick="showSection('inicio', event); return false;" class="active">
                    <i class="fas fa-home"></i>
                    <span>In√≠cio</span>
                </a></li>
                <li><a href="#" onclick="showSection('infraestrutura', event); return false;">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a></li>
                <li><a href="#" onclick="showSection('enderecos', event); return false;">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Cadastro de Endere√ßos</span>
                </a></li>
                <li><a href="#" onclick="showSection('gestao-projetos', event); return false;">
                    <i class="fas fa-project-diagram"></i>
                    <span>Gest√£o de Projetos</span>
                </a></li>
            </ul>
            <div class="sidebar-footer">
                <!-- Novo dropdown do usu√°rio - vers√£o simplificada -->
                <div class="new-user-dropdown" id="newUserDropdown">
                    <div class="user-profile-btn" id="userProfileBtn" onclick="toggleNewDropdown()">
                        <div class="user-avatar-simple">
                            <img src="https://ui-avatars.com/api/?name=U&background=667eea&color=fff&size=40" alt="Avatar" id="userAvatarSimple">
                        </div>
                        <div class="user-info-simple">
                            <span class="user-name-simple" id="userNameSimple">Usu√°rio</span>
                            <span class="user-role-simple" id="userRoleSimple">USER</span>
                        </div>
                        <div class="dropdown-arrow">
                            <i class="fas fa-chevron-down" id="dropdownArrow"></i>
                        </div>
                    </div>
                    
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="dropdown-header">
                            <div class="user-avatar-large">
                                <img src="https://ui-avatars.com/api/?name=U&background=667eea&color=fff&size=60" alt="Avatar" id="userAvatarLarge">
                            </div>
                            <div>
                                <div class="dropdown-user-name" id="dropdownUserName">Usu√°rio</div>
                                <div class="dropdown-user-email" id="dropdownUserEmail">usuario@inovar.com</div>
                            </div>
                        </div>
                        
                        <div class="dropdown-options">
                            <a href="#" class="dropdown-option" onclick="openUserProfile()">
                                <i class="fas fa-user"></i>
                                <span>Perfil</span>
                            </a>
                            <a href="#" class="dropdown-option" onclick="toggleColorblindMode()">
                                <i class="fas fa-eye"></i>
                                <span id="colorblindToggleText">Modo Dalt√¥nico</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-option logout-option" onclick="confirmLogout()">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Sair</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        
        <main class="main-content">
            <header class="top-bar">
                <div class="top-bar-content">
                    <div class="top-bar-decoration">
                        <div class="decoration-line"></div>
                        <div class="decoration-dot"></div>
                    </div>
                    <h1 id="section-title">In√≠cio</h1>
                    <div class="top-bar-actions">
                        <div class="status-indicator">
                            <span class="status-dot"></span>
                            <span class="status-text">Online</span>
                        </div>
                    </div>
                </div>
            </header>
            
            <div class="content-area">

                
                <div id="inicio" class="section active">
                    <div class="welcome-hero">
                        <div class="hero-particles"></div>
                        <div class="hero-content">
                            <div class="hero-icon-container">
                                <span class="icon-glow"></span>
                                <span class="hero-icon">üìä</span>
                            </div>
                            <h1 class="hero-title title-main">Sistema de Gest√£o de Infraestrutura</h1>
                            <span class="title-sub">Infraestrutura & Performance</span>
                            <p class="hero-subtitle">Plataforma completa para an√°lise de dados de infraestrutura com visualiza√ß√µes em tempo real</p>
                        </div>
                        <div class="hero-decoration">
                            <span class="decoration-circle circle-1"></span>
                            <span class="decoration-circle circle-2"></span>
                            <span class="decoration-circle circle-3"></span>
                        </div>
                    </div>

                    <section class="features-section">
                        <div class="section-header-intro">
                            <h2 class="section-title">Funcionalidades</h2>
                            <p class="section-description">Tudo o que voc√™ precisa para monitorar, analisar e exportar dados de infraestrutura de forma simples e visual.</p>
                        </div>
                        <div class="features-grid">
                            <div class="feature-card premium">
                                <div class="feature-icon-wrapper"><span class="feature-icon">üèóÔ∏è</span></div>
                                <h3>In√≠cio</h3>
                                <p>Vis√£o geral completa com todos os gr√°ficos e an√°lises integradas para acompanhamento em tempo real.</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon-wrapper"><span class="feature-icon">üîç</span></div>
                                <h3>Filtros Inteligentes</h3>
                                <p>Sistema avan√ßado de filtros por projeto, supervisor e per√≠odo para an√°lises espec√≠ficas.</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon-wrapper"><span class="feature-icon">‚ö°</span></div>
                                <h3>Dados em Tempo Real</h3>
                                <p>Carregamento autom√°tico de dados direto da planilha Google Sheets com atualiza√ß√£o cont√≠nua.</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon-wrapper"><span class="feature-icon">üìÅ</span></div>
                                <h3>Exporta√ß√£o Completa</h3>
                                <p>Exporte dados filtrados em formato CSV para an√°lises externas e relat√≥rios personalizados.</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon-wrapper"><span class="feature-icon">üìà</span></div>
                                <h3>An√°lises Visuais</h3>
                                <p>Gr√°ficos interativos com Chart.js para visualiza√ß√£o clara e intuitiva dos dados.</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon-wrapper"><span class="feature-icon">üë•</span></div>
                                <h3>Gest√£o de Equipes</h3>
                                <p>Acompanhe a produtividade das equipes e supervisores com m√©tricas detalhadas.</p>
                            </div>
                        </div>
                    </section>

                    <section class="quick-start-section">
                        <div class="start-header">
                            <span class="start-icon">üöÄ</span>
                            <h3>Como Come√ßar</h3>
                            <p>Siga os passos abaixo para explorar todo o potencial do sistema:</p>
                        </div>
                        <div class="steps-timeline">
                            <div class="step-card">
                                <div class="step-indicator">
                                    <span class="step-number">1</span>
                                    <span class="step-line"></span>
                                </div>
                                <div class="step-details">
                                    <h4>Acesse a Infraestrutura</h4>
                                    <p>Clique em <b>Infraestrutura</b> no menu lateral para ver todos os gr√°ficos.</p>
                                </div>
                            </div>
                            <div class="step-card">
                                <div class="step-indicator">
                                    <span class="step-number">2</span>
                                    <span class="step-line"></span>
                                </div>
                                <div class="step-details">
                                    <h4>Configure os Filtros</h4>
                                    <p>Use os filtros por projeto, supervisor e per√≠odo para an√°lises espec√≠ficas.</p>
                                </div>
                            </div>
                            <div class="step-card">
                                <div class="step-indicator">
                                    <span class="step-number">3</span>
                                </div>
                                <div class="step-details">
                                    <h4>Explore os Dados</h4>
                                    <p>Navegue pelos gr√°ficos interativos e acompanhe as m√©tricas em tempo real.</p>
                                </div>
                            </div>
                        </div>
                    </section>




                </div>
                
                <div id="infraestrutura" class="section">
                    <div class="infra-hero">
                        <div class="infra-hero-content">
                            <span class="infra-hero-icon">üèóÔ∏è</span>
                            <h2 class="infra-hero-title">Dashboard - Infraestrutura</h2>
                            <span class="infra-hero-badge">Atualiza√ß√£o Autom√°tica <span class="status-dot"></span></span>
                            <p class="infra-hero-desc">Acompanhe a produtividade, desempenho e evolu√ß√£o das equipes MDU em tempo real.<br>Utilize os filtros para an√°lises detalhadas e exporte relat√≥rios facilmente.</p>
                        </div>
                        <div class="infra-hero-decoration"></div>
                    </div>
                    <div class="section-header">
                        <div class="header-title">
                            <!-- h2 removido, j√° est√° no hero -->
                        </div>
                    </div>
                    <hr class="infra-divider" />
                    
                    <!-- Filtros da Infraestrutura -->
                    <div class="infra-filters-container">
                        <div class="filters-header">
                            <h4>üîç Filtros de An√°lise</h4>
                            <p>Filtre os dados para an√°lises espec√≠ficas</p>
                            <div class="infra-update-time">
                                <span class="update-icon">üïê</span>
                                <span id="infraLastUpdateTime">Atualizado em --/--/----, --:--:--</span>
                            </div>
                        </div>
                        
                        <div class="filters-grid">
                            <div class="filter-group">
                                <label for="infraFilterProjeto">Projeto</label>
                                <select id="infraFilterProjeto" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterSubProjeto">Sub-Projeto</label>
                                <select id="infraFilterSubProjeto" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterEquipe">Equipe</label>
                                <select id="infraFilterEquipe" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterStatus">Status</label>
                                <select id="infraFilterStatus" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterCidade">Cidade</label>
                                <select id="infraFilterCidade" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterSupervisor">Supervisor</label>
                                <select id="infraFilterSupervisor" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterTipoAcao">Tipo de A√ß√£o</label>
                                <select id="infraFilterTipoAcao" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="infraFilterCondominio">Condom√≠nio</label>
                                <select id="infraFilterCondominio" multiple onchange="applyInfraFilters()">
                                </select>
                            </div>
                            
                            <div class="filter-group periodo-filter">
                                <label for="infraFilterDataRecebimento">Per√≠odo de Recebimento</label>
                                <div class="periodo-inputs">
                                    <input type="date" id="infraFilterDataInicio" placeholder="Data In√≠cio" onchange="applyInfraFilters()">
                                    <span class="periodo-separator">at√©</span>
                                    <input type="date" id="infraFilterDataFim" placeholder="Data Fim" onchange="applyInfraFilters()">
                                </div>
                            </div>
                        </div>
                        
                        <div class="filters-actions">
                            <button onclick="clearInfraFilters()" class="btn-clean btn-filter-clear">
                                <span class="btn-icon">üîÑ</span>
                                <span class="btn-text">Limpar Filtros</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Cards de Estat√≠sticas da Infraestrutura -->
                    <div class="infra-stats-cards">
                        <div class="infra-stat-card blue">
                            <div class="stat-content">
                                <span class="stat-label">Total de Registros</span>
                                <span class="stat-value" id="infraStatTotalRegistros">0</span>
                                <span class="stat-desc">Registros cadastrados</span>
                            </div>
                            <div class="stat-icon">üìã</div>
                        </div>
                        <div class="infra-stat-card green">
                            <div class="stat-content">
                                <span class="stat-label">Endere√ßos Distintos</span>
                                <span class="stat-value" id="infraStatEnderecosDistintos">0</span>
                                <span class="stat-desc">Endere√ßos √∫nicos</span>
                            </div>
                            <div class="stat-icon">üè†</div>
                        </div>
                        <div class="infra-stat-card orange">
                            <div class="stat-content">
                                <span class="stat-label">Equipes Distintas</span>
                                <span class="stat-value" id="infraStatEquipesDistintas">0</span>
                                <span class="stat-desc">Equipes √∫nicas</span>
                            </div>
                            <div class="stat-icon">üë•</div>
                        </div>
                        <div class="infra-stat-card purple">
                            <div class="stat-content">
                                <span class="stat-label">Produtividade</span>
                                <span class="stat-value" id="infraStatProdutividade">0%</span>
                                <span class="stat-desc">Total / Produtiva</span>
                            </div>
                            <div class="stat-icon">‚ö°</div>
                        </div>
                        <div class="infra-stat-card red">
                            <div class="stat-content">
                                <span class="stat-label">Tempo M√©dio de Execu√ß√£o</span>
                                <span class="stat-value" id="infraStatTempoMedio">0</span>
                                <span class="stat-desc">Dias (Recebimento ‚Üí Final)</span>
                            </div>
                            <div class="stat-icon">‚è±Ô∏è</div>
                        </div>

                        <!-- Novo: Tempo M√©dio Sala T√©cnica (Recebimento ‚Üí In√≠cio) -->
                        <div class="infra-stat-card red">
                            <div class="stat-content">
                                <span class="stat-label">Tempo M√©dio Sala T√©cnica</span>
                                <span class="stat-value" id="infraStatTempoSalaTecnica">0</span>
                                <span class="stat-desc">Dias (Recebimento ‚Üí In√≠cio)</span>
                            </div>
                            <div class="stat-icon">üß∞</div>
                        </div>

                        <!-- Novo: Tempo M√©dio T√©cnicos (In√≠cio ‚Üí Final) -->
                        <div class="infra-stat-card red">
                            <div class="stat-content">
                                <span class="stat-label">Tempo M√©dio T√©cnicos</span>
                                <span class="stat-value" id="infraStatTempoTecnicos">0</span>
                                <span class="stat-desc">Dias (In√≠cio ‚Üí Final)</span>
                            </div>
                            <div class="stat-icon">üë∑</div>
                        </div>
                    </div>
                    
                    <!-- Caixa de An√°lise de Projetos -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìä An√°lise de Projetos</h3>
                            <p>Quantidade de Projetos e seus Percentuais</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="projetosChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Caixa de An√°lise de Sub Projetos -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìä An√°lise de Sub Projetos</h3>
                            <p>Quantidade de Sub Projetos e seus Percentuais</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="subProjetosChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Caixa de An√°lise de Cidades -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìä An√°lise de Cidades</h3>
                            <p>Quantidade por Cidade e seus Percentuais</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="cidadesChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Caixa de An√°lise de HP por Projeto -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìä An√°lise de HP por Projeto</h3>
                            <p>Soma de HP Ativados por Projeto</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="hpProjetosChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Caixa de An√°lise de Recebimentos por M√™s -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìÖ An√°lise de Recebimentos e Conclus√µes</h3>
                            <p>Registros Recebidos vs Conclu√≠dos por M√™s</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="recebimentosChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Caixa de An√°lise de Endere√ßos por Supervisor -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üìä An√°lise de Endere√ßos por Supervisor</h3>
                            <p>Quantidade por Status (Produtiva/Improdutiva)</p>
                        </div>
                        <div class="analysis-content">
                            <div class="chart-container">
                                <canvas id="supervisorStatusChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Container para as duas tabelas de ranking lado a lado -->
                    <div class="analysis-section">
                        <div class="analysis-header">
                            <h3>üèÜ Rankings das Equipes</h3>
                            <p>An√°lise por Tipo de A√ß√£o e Status</p>
                            <div class="export-controls">
                                <button class="btn btn-secondary" onclick="exportAllRankings()">
                                    <i class="fas fa-download"></i> Exportar Rankings (XLSX)
                                </button>
                            </div>
                        </div>
                        <div class="analysis-content">
                            <div class="rankings-grid">
                                <!-- Tabela de Ranking das Equipes por Tipo de A√ß√£o -->
                                <div class="ranking-table-container">
                                    <div class="table-header">
                                        <h4>üìä Por Tipo de A√ß√£o</h4>
                                    </div>
                                    <div class="table-responsive">
                                        <table id="equipeRankingTable" class="ranking-table">
                                            <thead>
                                                <tr>
                                                    <th>Rank</th>
                                                    <th>Equipe</th>
                                                    <th>ATIVA√á√ÉO</th>
                                                    <th>CONSTRU√á√ÉO</th>
                                                    <th>VISTORIA</th>
                                                    <th>Total</th>
                                                </tr>
                                            </thead>
                                            <tbody id="equipeRankingTableBody">
                                                <!-- Dados ser√£o inseridos dinamicamente -->
                                            </tbody>
                                            <tfoot>
                                                <tr class="total-row">
                                                    <td colspan="2"><strong>Total Geral</strong></td>
                                                    <td id="totalAtivacao">0</td>
                                                    <td id="totalConstrucao">0</td>
                                                    <td id="totalVistoria">0</td>
                                                    <td id="totalGeral">0</td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>

                                <!-- Tabela de Ranking das Equipes por Status -->
                                <div class="ranking-table-container">
                                    <div class="table-header">
                                        <h4>üìà Por Status</h4>
                                    </div>
                                    <div class="table-responsive">
                                        <table id="equipeStatusRankingTable" class="ranking-table">
                                            <thead>
                                                <tr>
                                                    <th>Rank</th>
                                                    <th>Equipe</th>
                                                    <th>PRODUTIVA</th>
                                                    <th>IMPRODUTIVA</th>
                                                    <th>Total</th>
                                                    <th>Produtividade</th>
                                                </tr>
                                            </thead>
                                            <tbody id="equipeStatusRankingTableBody">
                                                <!-- Dados ser√£o inseridos dinamicamente -->
                                            </tbody>
                                            <tfoot>
                                                <tr class="total-row">
                                                    <td colspan="2"><strong>Total Geral</strong></td>
                                                    <td id="totalProdutiva">0</td>
                                                    <td id="totalImprodutiva">0</td>
                                                    <td id="totalStatusGeral">0</td>
                                                    <td id="totalProdutividade">0%</td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Se√ß√£o CRUD de Endere√ßos -->
                <div id="enderecos" class="section">
                    <div class="endereco-stats-cards">
                        <div class="endereco-stat-card blue">
                            <div class="stat-content">
                                <span class="stat-label">Total de Registros</span>
                                <span class="stat-value" id="statTotalRegistros">0</span>
                                <span class="stat-desc">Endere√ßos cadastrados</span>
                            </div>
                            <div class="stat-icon">üìã</div>
                        </div>
                        <div class="endereco-stat-card green">
                            <div class="stat-content">
                                <span class="stat-label">Endere√ßos Distintos</span>
                                <span class="stat-value" id="statEnderecosDistintos">0</span>
                                <span class="stat-desc">Endere√ßos √∫nicos</span>
                            </div>
                            <div class="stat-icon">üè†</div>
                        </div>
                        <div class="endereco-stat-card orange">
                            <div class="stat-content">
                                <span class="stat-label">Equipes Distintas</span>
                                <span class="stat-value" id="statEquipesDistintas">0</span>
                                <span class="stat-desc">Equipes √∫nicas</span>
                            </div>
                            <div class="stat-icon">üë•</div>
                        </div>
                        <div class="endereco-stat-card purple">
                            <div class="stat-content">
                                <span class="stat-label">Produtividade</span>
                                <span class="stat-value" id="statProdutividade">0%</span>
                                <span class="stat-desc">Total / Produtiva</span>
                            </div>
                            <div class="stat-icon">‚ö°</div>
                        </div>
                    </div>
                    <div class="crud-header">
                        <div class="crud-title">
                            <h2>üè† Cadastro de Endere√ßos</h2>
                            <p>Gerencie todos os endere√ßos do sistema MDU</p>
                        </div>
                        <div class="btn-group">
                            <button class="btn-primary" onclick="abrirNovoEndereco()">
                                <span class="btn-icon">‚ûï</span>
                                Novo Endere√ßo
                            </button>
                            <div class="upload-excel-container">
                                <input type="file" id="excelUpload" accept=".xlsx,.xls" style="display: none;">
                                <button class="btn-upload-excel" onclick="document.getElementById('excelUpload').click()">
                                    <span class="btn-icon">üìä</span>
                                    Importar Excel
                                </button>
                                <button class="btn btn-outline-primary" onclick="generateStandardTemplate()" style="margin-left: 10px;" title="Baixar planilha modelo com colunas padronizadas">
                                    <span class="btn-icon">üìã</span>
                                    Template Padr√£o
                                </button>
                            </div>
                            <!-- Bot√£o de Admin para Limpeza -->
                            <div class="admin-controls" id="adminControls" style="display: none;">
                                <button class="btn-danger-admin" onclick="showAdminCleanupOptions()" title="Apenas para Administradores">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                    Admin: Limpar Dados
                                </button>
                            </div>
                        </div>
                    </div>



                    <!-- Status da Conex√£o Firebase -->
                    <div id="firebaseStatus" class="firebase-status">
                        <div class="status-indicator">
                            <span class="status-dot connecting"></span>
                            <span class="status-text">Conectando ao Firebase...</span>
                        </div>
                    </div>

                    <!-- Filtros de Busca -->
                    <div class="search-filters">
                        <div class="search-bar">
                            <input type="text" id="dynamicSearchInput" placeholder="üîç Buscar..." onkeyup="filterDynamicTable()">
                        </div>
                        <div class="filter-actions">
                            <button onclick="refreshTableData()" class="btn-refresh" title="Recarregar dados">
                                <span class="btn-icon">üîÑ</span>
                                Atualizar
                            </button>
                        </div>
                    </div>

                    <!-- Nova Tabela Firebase Din√¢mica -->
                    <div class="firebase-table-container">
                        <div class="table-header">
                            <h4>üìä Dados da Planilha</h4>
                            <div class="table-stats">
                                <span id="tableRecordCount">0 registros</span>
                                <span id="tableLastUpdate">√öltima atualiza√ß√£o: --</span>
                            </div>
                        </div>
                        
                        <div class="table-wrapper">
                            <table class="firebase-table" id="firebaseTable">
                                <thead id="firebaseTableHead">
                                    <tr>
                                        <th>Carregando...</th>
                                    </tr>
                                </thead>
                                <tbody id="firebaseTableBody">
                                    <tr>
                                        <td style="text-align: center; padding: 40px;">
                                            <div class="loading-spinner">
                                                <div class="spinner"></div>
                                                <p>Carregando dados do Firebase...</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Mensagem quando n√£o h√° dados -->
                        <div id="noDataMessage" class="no-data-message" style="display: none;">
                            <div class="no-data-icon">üìä</div>
                            <h3>Nenhum dado encontrado</h3>
                            <p>Fa√ßa o upload de uma planilha Excel para come√ßar.</p>
                            <button onclick="document.getElementById('excelUpload').click()" class="btn-primary">
                                <span class="btn-icon">üìä</span>
                                Importar Excel
                            </button>
                        </div>
                    </div>
                </div>


                <!-- Se√ß√£o de Gest√£o de Projetos -->
                <div id="gestao-projetos" class="section">
                    <div class="gestao-hero">
                        <div class="gestao-hero-content">
                            <div class="gestao-hero-icon">
                                üóÇÔ∏è
                            </div>
                            <div class="gestao-hero-text">
                                <h1 class="gestao-hero-title">Gest√£o de Projetos</h1>
                                <p class="gestao-hero-desc">Gerencie projetos, clientes e configura√ß√µes do sistema</p>
                            </div>
                        </div>

                    </div>

                    <div class="gestao-tabs">
                        <button class="gestao-tab-btn active" onclick="showGestaoTab('projetos')">
                            <i class="fas fa-building"></i>
                            <span>Projetos</span>
                        </button>
                        <button class="gestao-tab-btn" onclick="showGestaoTab('subprojetos')">
                            <i class="fas fa-sitemap"></i>
                            <span>Sub Projetos</span>
                        </button>
                        <button class="gestao-tab-btn" onclick="showGestaoTab('tipos-acao')">
                            <i class="fas fa-tasks"></i>
                            <span>Tipos de A√ß√£o</span>
                        </button>
                        <button class="gestao-tab-btn" onclick="showGestaoTab('supervisores')">
                            <i class="fas fa-user-tie"></i>
                            <span>Supervisores</span>
                        </button>
                        <button class="gestao-tab-btn" onclick="showGestaoTab('equipes')">
                            <i class="fas fa-users"></i>
                            <span>Equipes</span>
                        </button>
                        <button class="gestao-tab-btn" onclick="showGestaoTab('cidades')">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Cidades</span>
                        </button>
                    </div>

                    <!-- Tab de Projetos -->
                    <div id="gestao-projetos-tab" class="gestao-tab-content active">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-building"></i> Projetos</h2>
                                <p>Gerencie os projetos principais</p>
                            </div>
                            <div class="gestao-actions">
                                <button class="btn-primary" onclick="openGestaoModal('projetoModal')">
                                    <i class="fas fa-plus"></i> Novo Projeto
                                </button>
                            </div>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome do Projeto</th>
                                        <th>Cliente</th>
                                        <th>Descri√ß√£o</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="projetosTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab de Sub Projetos -->
                    <div id="gestao-subprojetos-tab" class="gestao-tab-content">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-sitemap"></i> Sub Projetos</h2>
                                <p>Gerencie os sub projetos dentro de cada projeto principal</p>
                            </div>
                            <button class="btn-primary" onclick="openGestaoModal('subprojetoModal')">
                                <i class="fas fa-plus"></i> Novo Sub Projeto
                            </button>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome</th>
                                        <th>Projeto Principal</th>
                                        <th>Descri√ß√£o</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="subprojetosTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab de Tipos de A√ß√£o -->
                    <div id="gestao-tipos-acao-tab" class="gestao-tab-content">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-tasks"></i> Tipos de A√ß√£o</h2>
                                <p>Gerencie os tipos de a√ß√£o dispon√≠veis (Vistoria, Constru√ß√£o, etc.)</p>
                            </div>
                            <button class="btn-primary" onclick="openGestaoModal('tipoAcaoModal')">
                                <i class="fas fa-plus"></i> Novo Tipo de A√ß√£o
                            </button>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome</th>
                                        <th>Descri√ß√£o</th>
                                        <th>Categoria</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="tiposAcaoTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab de Supervisores -->
                    <div id="gestao-supervisores-tab" class="gestao-tab-content">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-user-tie"></i> Supervisores</h2>
                                <p>Gerencie os supervisores respons√°veis pelos projetos</p>
                            </div>
                            <button class="btn-primary" onclick="openGestaoModal('supervisorModal')">
                                <i class="fas fa-plus"></i> Novo Supervisor
                            </button>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome</th>
                                        <th>Email</th>
                                        <th>Telefone</th>
                                        <th>√Årea</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="supervisoresTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab de Equipes -->
                    <div id="gestao-equipes-tab" class="gestao-tab-content">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-users"></i> Equipes</h2>
                                <p>Gerencie as equipes de trabalho</p>
                            </div>
                            <button class="btn-primary" onclick="openGestaoModal('equipeModal')">
                                <i class="fas fa-plus"></i> Nova Equipe
                            </button>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome da Equipe</th>
                                        <th>L√≠der</th>
                                        <th>Membros</th>
                                        <th>Especialidade</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="equipesTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab de Cidades -->
                    <div id="gestao-cidades-tab" class="gestao-tab-content">
                        <div class="gestao-header">
                            <div class="gestao-title">
                                <h2><i class="fas fa-map-marker-alt"></i> Cidades</h2>
                                <p>Gerencie as cidades onde atuamos</p>
                            </div>
                            <button class="btn-primary" onclick="openGestaoModal('cidadeModal')">
                                <i class="fas fa-plus"></i> Nova Cidade
                            </button>
                        </div>

                        <div class="crud-table-container">
                            <table class="crud-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Nome da Cidade</th>
                                        <th>Estado</th>
                                        <th>Regi√£o</th>
                                        <th>Status</th>
                                        <th>Data Cria√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="cidadesTableBody">
                                    <!-- Dados ser√£o carregados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
            </div>
        </main>
    </div>

    <!-- Modal CRUD -->
    <div id="crudModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Novo Endere√ßo</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="enderecoForm" class="modal-form">
                <div class="form-grid">
                    <!-- Coluna 1: Informa√ß√µes B√°sicas e Localiza√ß√£o -->
                    <div class="form-column">
                        <!-- Informa√ß√µes B√°sicas -->
                        <div class="form-section">
                            <h4>üìã Informa√ß√µes B√°sicas</h4>
                            
                            <div class="form-group">
                                <label for="projeto">Projeto *</label>
                                <select id="projeto" name="projeto" required>
                                    <option value="">Selecione o projeto...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="subProjeto">Sub Projeto *</label>
                                <select id="subProjeto" name="subProjeto" required>
                                    <option value="">Selecione o sub projeto...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="tipoAcao">Tipo de A√ß√£o *</label>
                                <select id="tipoAcao" name="tipoAcao" required>
                                    <option value="">Selecione o tipo de a√ß√£o...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="contrato">Contrato</label>
                                <input type="text" id="contrato" name="contrato" placeholder="N√∫mero do contrato">
                            </div>
                        </div>

                        <!-- Localiza√ß√£o -->
                        <div class="form-section">
                            <h4>üìç Localiza√ß√£o</h4>
                            
                            <div class="form-group">
                                <label for="condominio">Condom√≠nio *</label>
                                <input type="text" id="condominio" name="condominio" required placeholder="Nome do condom√≠nio">
                            </div>

                            <div class="form-group">
                                <label for="endereco">Endere√ßo *</label>
                                <input type="text" id="endereco" name="endereco" required placeholder="Endere√ßo completo">
                            </div>

                            <div class="form-group">
                                <label for="cidade">Cidade *</label>
                                <select id="cidade" name="cidade" required>
                                    <option value="">Selecione a cidade...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="andar">Andar</label>
                                <input type="text" id="andar" name="andar" placeholder="N√∫mero do andar">
                            </div>
                        </div>

                        <!-- Dados T√©cnicos -->
                        <div class="form-section">
                            <h4>‚öôÔ∏è Dados T√©cnicos</h4>
                            
                            <div class="form-group">
                                <label for="pep">PEP</label>
                                <select id="pep" name="pep">
                                    <option value="">Selecione o PEP...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="codImovelGed">COD IMOVEL GED</label>
                                <input type="text" id="codImovelGed" name="codImovelGed" placeholder="C√≥digo GED">
                            </div>

                            <div class="form-group">
                                <label for="nodeGerencial">NODE GERENCIAL</label>
                                <input type="text" id="nodeGerencial" name="nodeGerencial" placeholder="Ex: PIT50">
                            </div>

                            <div class="form-group">
                                <label for="areaTecnica">√Årea T√©cnica</label>
                                <input type="text" id="areaTecnica" name="areaTecnica" placeholder="Ex: PTBAA">
                            </div>

                            <div class="form-group">
                                <label for="hp">HP *</label>
                                <input type="number" id="hp" name="hp" required placeholder="Quantidade HP" min="1">
                            </div>
                        </div>
                    </div>

                    <!-- Coluna 2: Equipe, Status e Outros -->
                    <div class="form-column">
                        <!-- Equipe e Status -->
                        <div class="form-section">
                            <h4>üë• Equipe e Status</h4>
                            
                            <div class="form-group">
                                <label for="equipe">Equipe *</label>
                                <select id="equipe" name="equipe" required>
                                    <option value="">Selecione a equipe...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="supervisor">Supervisor *</label>
                                <select id="supervisor" name="supervisor" required>
                                    <option value="">Selecione o supervisor...</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="status">Status *</label>
                                <select id="status" name="status" required>
                                    <option value="">Selecione o status...</option>
                                    <option value="PRODUTIVA">PRODUTIVA</option>
                                    <option value="IMPRODUTIVA">IMPRODUTIVA</option>
                                </select>
                            </div>
                        </div>

                        <!-- Cronograma -->
                        <div class="form-section">
                            <h4>üìÖ Cronograma</h4>
                            
                            <div class="form-group">
                                <label for="dataRecebimento">Data Recebimento</label>
                                <input type="date" id="dataRecebimento" name="dataRecebimento">
                            </div>

                            <div class="form-group">
                                <label for="dataInicio">Data In√≠cio</label>
                                <input type="date" id="dataInicio" name="dataInicio">
                            </div>

                            <div class="form-group">
                                <label for="dataFinal">Data Final</label>
                                <input type="date" id="dataFinal" name="dataFinal">
                            </div>
                        </div>

                        <!-- Informa√ß√µes Adicionais -->
                        <div class="form-section">
                            <h4>üìù Informa√ß√µes Adicionais</h4>
                            
                            <div class="form-group">
                                <label for="rdo">RDO</label>
                                <select id="rdo" name="rdo">
                                    <option value="">Selecione...</option>
                                    <option value="SIM">SIM</option>
                                    <option value="N√ÉO">N√ÉO</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="book">BOOK</label>
                                <select id="book" name="book">
                                    <option value="">Selecione...</option>
                                    <option value="SIM">SIM</option>
                                    <option value="N√ÉO">N√ÉO</option>
                                    <option value="KIT ENVIADO">KIT ENVIADO</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="projetoStatus">Status do Projeto</label>
                                <select id="projetoStatus" name="projetoStatus">
                                    <option value="">Selecione...</option>
                                    <option value="CONCLUIDO">CONCLUIDO</option>
                                    <option value="EM ANDAMENTO">EM ANDAMENTO</option>
                                    <option value="PARADO">PARADO</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="situacao">Situa√ß√£o</label>
                                <input type="text" id="situacao" name="situacao" placeholder="Situa√ß√£o atual">
                            </div>

                            <div class="form-group">
                                <label for="justificativa">Justificativa</label>
                                <textarea id="justificativa" name="justificativa" placeholder="Justificativa se necess√°rio"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="observacao">Observa√ß√£o</label>
                                <textarea id="observacao" name="observacao" placeholder="Observa√ß√µes gerais"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn-primary" id="submitBtn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Projetos -->
    <div id="projetoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-building"></i> Novo Projeto</h3>
                <span class="close" onclick="closeGestaoModal('projetoModal')">&times;</span>
            </div>
            <form id="projetoForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üìã Informa√ß√µes do Projeto</h4>
                        
                        <div class="form-group">
                            <label for="projetoNome">Nome do Projeto *</label>
                            <input type="text" id="projetoNome" name="nome" required placeholder="Ex: Claro, Vivo, etc.">
                        </div>

                        <div class="form-group">
                            <label for="projetoCliente">Cliente *</label>
                            <input type="text" id="projetoCliente" name="cliente" required placeholder="Nome do cliente">
                        </div>

                        <div class="form-group">
                            <label for="projetoDescricao">Descri√ß√£o</label>
                            <textarea id="projetoDescricao" name="descricao" placeholder="Descri√ß√£o detalhada do projeto"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="projetoStatus">Status *</label>
                            <select id="projetoStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                                <option value="PAUSADO">Pausado</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Projeto</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('projetoModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Sub Projetos -->
    <div id="subprojetoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sitemap"></i> Novo Sub Projeto</h3>
                <span class="close" onclick="closeGestaoModal('subprojetoModal')">&times;</span>
            </div>
            <form id="subprojetoForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üìã Informa√ß√µes do Sub Projeto</h4>
                        
                        <div class="form-group">
                            <label for="subprojetoNome">Nome *</label>
                            <input type="text" id="subprojetoNome" name="nome" required placeholder="Nome do sub projeto">
                        </div>

                        <div class="form-group">
                            <label for="subprojetoProjeto">Projeto Principal *</label>
                            <select id="subprojetoProjeto" name="projetoPrincipal" required>
                                <option value="">Selecione o projeto principal...</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="subprojetoDescricao">Descri√ß√£o</label>
                            <textarea id="subprojetoDescricao" name="descricao" placeholder="Descri√ß√£o do sub projeto"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="subprojetoStatus">Status *</label>
                            <select id="subprojetoStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                                <option value="PAUSADO">Pausado</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Sub Projeto</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('subprojetoModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Tipos de A√ß√£o -->
    <div id="tipoAcaoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-tasks"></i> Novo Tipo de A√ß√£o</h3>
                <span class="close" onclick="closeGestaoModal('tipoAcaoModal')">&times;</span>
            </div>
            <form id="tipoAcaoForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üìã Informa√ß√µes do Tipo de A√ß√£o</h4>
                        
                        <div class="form-group">
                            <label for="tipoAcaoNome">Nome *</label>
                            <input type="text" id="tipoAcaoNome" name="nome" required placeholder="Ex: Vistoria, Constru√ß√£o, etc.">
                        </div>

                        <div class="form-group">
                            <label for="tipoAcaoDescricao">Descri√ß√£o</label>
                            <textarea id="tipoAcaoDescricao" name="descricao" placeholder="Descri√ß√£o do tipo de a√ß√£o"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="tipoAcaoCategoria">Categoria *</label>
                            <select id="tipoAcaoCategoria" name="categoria" required>
                                <option value="">Selecione...</option>
                                <option value="VISTORIA">Vistoria</option>
                                <option value="CONSTRU√á√ÉO">Constru√ß√£o</option>
                                <option value="ATIVA√á√ÉO">Ativa√ß√£o</option>
                                <option value="MANUTEN√á√ÉO">Manuten√ß√£o</option>
                                <option value="ADMINISTRATIVO">Administrativo</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="tipoAcaoStatus">Status *</label>
                            <select id="tipoAcaoStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Tipo de A√ß√£o</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('tipoAcaoModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Supervisores -->
    <div id="supervisorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-tie"></i> Novo Supervisor</h3>
                <span class="close" onclick="closeGestaoModal('supervisorModal')">&times;</span>
            </div>
            <form id="supervisorForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üë§ Informa√ß√µes Pessoais</h4>
                        
                        <div class="form-group">
                            <label for="supervisorNome">Nome Completo *</label>
                            <input type="text" id="supervisorNome" name="nome" required placeholder="Nome completo">
                        </div>

                        <div class="form-group">
                            <label for="supervisorEmail">Email *</label>
                            <input type="email" id="supervisorEmail" name="email" required placeholder="email@exemplo.com">
                        </div>

                        <div class="form-group">
                            <label for="supervisorTelefone">Telefone</label>
                            <input type="tel" id="supervisorTelefone" name="telefone" placeholder="(11) 99999-9999">
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>üè¢ Informa√ß√µes Profissionais</h4>
                        
                        <div class="form-group">
                            <label for="supervisorArea">√Årea de Atua√ß√£o *</label>
                            <input type="text" id="supervisorArea" name="area" required placeholder="Ex: Vistoria, Constru√ß√£o, etc.">
                        </div>

                        <div class="form-group">
                            <label for="supervisorStatus">Status *</label>
                            <select id="supervisorStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                                <option value="FERIAS">F√©rias</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Supervisor</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('supervisorModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Equipes -->
    <div id="equipeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-users"></i> Nova Equipe</h3>
                <span class="close" onclick="closeGestaoModal('equipeModal')">&times;</span>
            </div>
            <form id="equipeForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üë• Informa√ß√µes da Equipe</h4>
                        
                        <div class="form-group">
                            <label for="equipeNome">Nome da Equipe *</label>
                            <input type="text" id="equipeNome" name="nome" required placeholder="Nome da equipe">
                        </div>

                        <div class="form-group">
                            <label for="equipeLider">L√≠der da Equipe *</label>
                            <select id="equipeLider" name="lider" required>
                                <option value="">Selecione o l√≠der...</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="equipeMembros">Membros</label>
                            <textarea id="equipeMembros" name="membros" placeholder="Lista de membros da equipe"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="equipeEspecialidade">Especialidade *</label>
                            <input type="text" id="equipeEspecialidade" name="especialidade" required placeholder="Ex: Vistoria, Constru√ß√£o, etc.">
                        </div>

                        <div class="form-group">
                            <label for="equipeStatus">Status *</label>
                            <select id="equipeStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                                <option value="EM_CAMPO">Em Campo</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Equipe</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('equipeModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Cidades -->
    <div id="cidadeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-map-marker-alt"></i> Nova Cidade</h3>
                <span class="close" onclick="closeGestaoModal('cidadeModal')">&times;</span>
            </div>
            <form id="cidadeForm" class="modal-form">
                <div class="form-grid">
                    <div class="form-section">
                        <h4>üèôÔ∏è Informa√ß√µes da Cidade</h4>
                        
                        <div class="form-group">
                            <label for="cidadeNome">Nome da Cidade *</label>
                            <input type="text" id="cidadeNome" name="nome" required placeholder="Nome da cidade">
                        </div>

                        <div class="form-group">
                            <label for="cidadeEstado">Estado *</label>
                            <select id="cidadeEstado" name="estado" required>
                                <option value="">Selecione o estado...</option>
                                <option value="BA">Bahia</option>
                                <option value="SP">S√£o Paulo</option>
                                <option value="RJ">Rio de Janeiro</option>
                                <option value="MG">Minas Gerais</option>
                                <option value="RS">Rio Grande do Sul</option>
                                <option value="PR">Paran√°</option>
                                <option value="SC">Santa Catarina</option>
                                <option value="GO">Goi√°s</option>
                                <option value="MT">Mato Grosso</option>
                                <option value="MS">Mato Grosso do Sul</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="cidadeRegiao">Regi√£o</label>
                            <input type="text" id="cidadeRegiao" name="regiao" placeholder="Ex: Nordeste, Sudeste, etc.">
                        </div>

                        <div class="form-group">
                            <label for="cidadeStatus">Status *</label>
                            <select id="cidadeStatus" name="status" required>
                                <option value="ATIVO">Ativo</option>
                                <option value="INATIVO">Inativo</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn-save">üíæ Salvar Cidade</button>
                    <button type="button" class="btn-cancel" onclick="closeGestaoModal('cidadeModal')">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>


    <!-- ===== NOVA TELA DE PERFIL DO USU√ÅRIO ===== -->
    <div id="userProfileScreen" class="profile-screen" style="display: none;">
        <div class="profile-container">
            <div class="profile-header">
                <button class="back-btn" onclick="closeUserProfileScreen()">
                    <i class="fas fa-arrow-left"></i>
                    Voltar
                </button>
                <h2><i class="fas fa-key"></i> Alterar Senha</h2>
            </div>

            <div class="profile-content">
                <div class="profile-sections">
                    <!-- Se√ß√£o de Seguran√ßa -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h3><i class="fas fa-shield-alt"></i> Alterar Senha</h3>
                            <p>Altere sua senha de acesso ao sistema</p>
                        </div>
                        <form class="profile-form" id="passwordForm">
                            <div class="form-group">
                                <label for="currentPassword">Senha Atual</label>
                                <div class="password-input">
                                    <input type="password" id="currentPassword" placeholder="Digite sua senha atual" required>
                                    <button type="button" class="toggle-password" onclick="togglePasswordVisibility('currentPassword')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="newPassword">Nova Senha</label>
                                    <div class="password-input">
                                        <input type="password" id="newPassword" placeholder="Digite a nova senha" required minlength="6">
                                        <button type="button" class="toggle-password" onclick="togglePasswordVisibility('newPassword')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <div class="password-hint">
                                        <ul class="password-requirements">
                                            <li>M√≠nimo 6 caracteres</li>
                                            <li>1 caracter especial</li>
                                            <li>1 letra mai√∫scula</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="confirmPassword">Confirmar Nova Senha</label>
                                    <div class="password-input">
                                        <input type="password" id="confirmPassword" placeholder="Confirme a nova senha" required>
                                        <button type="button" class="toggle-password" onclick="togglePasswordVisibility('confirmPassword')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn-save btn-password" onclick="changePassword()">
                                <i class="fas fa-key"></i>
                                Alterar Senha
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

                    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
    
    <!-- Firebase Sistema Unificado (PRODUCTION ONLY) -->
    <script src="src/js/firebase-complete.js?v=1.3&t=2025081813"></script>
    <script src="src/js/firestore-integration.js?v=1.3&t=2025081813"></script>
    <script src="src/js/dashboard-minimal.js?v=1.3&t=2025081813"></script>
    <script src="src/js/dashboard-functions.js?v=1.3&t=2025081813"></script>
    <script src="src/js/dashboard-handlers.js?v=1.3&t=2025081813"></script>
    <script src="src/js/firebase-table-system.js?v=4.2&t=2025081925"></script>
    <script src="src/js/multi-select-filters.js?v=1.0&t=2025081925"></script>
    <script src="src/js/excel-reader-complete.js?v=1.0&t=2025081925"></script>
    <script src="src/js/excel-template-standard.js?v=1.0&t=2025082020"></script>
    <script src="src/js/checkbox-dropdown.js?v=1.3&t=2025081813"></script>
    <script src="src/js/force-init-dropdowns.js?v=1.3&t=2025081813"></script>
    <script>
        // O script.js j√° tem o event listener DOMContentLoaded
        // N√£o precisamos duplicar aqui
        console.log('üìÑ Dashboard HTML carregado');
        
        // ============= FUN√á√ïES GLOBAIS DE GERENCIAMENTO =============
        function abrirNovoEndereco() {
            document.getElementById('modalTitle').textContent = 'Novo Endere√ßo';
            document.getElementById('crudModal').style.display = 'block';
        }
        
        function closeModal() {
            document.getElementById('crudModal').style.display = 'none';
        }
        
        function openGestaoModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }
        
        function closeGestaoModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function showGestaoTab(tabName) {
            // Esconder todas as abas
            const tabs = document.querySelectorAll('.gestao-tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remover classe active de todos os bot√µes
            const buttons = document.querySelectorAll('.gestao-tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Mostrar aba selecionada
            document.getElementById(`gestao-${tabName}-tab`).classList.add('active');
            
            // Adicionar classe active no bot√£o clicado
            event.target.classList.add('active');
        }
        
        function showSection(sectionName, event) {
            // Esconder todas as se√ß√µes
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Remover classe active de todos os links
            const links = document.querySelectorAll('.sidebar-menu a');
            links.forEach(link => link.classList.remove('active'));
            
            // Mostrar se√ß√£o selecionada
            document.getElementById(sectionName).classList.add('active');
            
            // Adicionar classe active no link clicado
            if (event) {
                event.target.classList.add('active');
            }
            
            // Atualizar t√≠tulo da se√ß√£o
            const titles = {
                'inicio': 'In√≠cio',
                'infraestrutura': 'Dashboard - Infraestrutura',
                'enderecos': 'Cadastro de Endere√ßos',
                'gestao-projetos': 'Gest√£o de Projetos'
            };
            
            document.getElementById('section-title').textContent = titles[sectionName] || sectionName;
        }
        
        // Fun√ß√µes para modo colorblind e perfil de usu√°rio (caso n√£o existam)
        function toggleColorblindMode() {
            console.log('Toggle colorblind mode');
            // TODO: Implementar modo dalt√¥nico
        }
        
        function openUserProfile() {
            document.getElementById('userProfileScreen').style.display = 'block';
        }
        
        function closeUserProfileScreen() {
            document.getElementById('userProfileScreen').style.display = 'none';
        }
        
        function confirmLogout() {
            if (confirm('Deseja realmente sair do sistema?')) {
                // TODO: Implementar logout
                console.log('Logout confirmado');
            }
        }
        
        function toggleNewDropdown() {
            const dropdown = document.getElementById('newUserDropdown');
            dropdown.classList.toggle('active');
        }
        
        // Fechar dropdown quando clicar fora
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('newUserDropdown');
            if (dropdown && !dropdown.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });
        
        // ============= FUN√á√ïES DE ADMIN PARA LIMPEZA =============
        function checkAdminPermissions() {
            // Verificar se o usu√°rio √© admin baseado no role
            const userRole = document.getElementById('userRoleSimple')?.textContent;
            const isAdmin = userRole && (userRole.includes('ADMIN') || userRole.includes('admin'));
            
            const adminControls = document.getElementById('adminControls');
            if (adminControls) {
                adminControls.style.display = isAdmin ? 'block' : 'none';
            }
            
            return isAdmin;
        }
        
        function showAdminCleanupOptions() {
            if (!checkAdminPermissions()) {
                alert('‚õî Acesso Negado\n\nApenas administradores podem acessar esta funcionalidade.');
                return;
            }
            
            const options = `
üóëÔ∏è OP√á√ïES DE LIMPEZA ADMINISTRATIVA

Escolha uma op√ß√£o:

1 - Limpar APENAS tabela de endere√ßos (preserva gest√£o)
2 - Limpar TODOS os dados (tabela + gest√£o de projetos)
0 - Cancelar

Digite o n√∫mero da op√ß√£o desejada:`;
            
            const choice = prompt(options);
            
            switch(choice) {
                case '1':
                    if (window.clearMainTableOnly) {
                        window.clearMainTableOnly();
                    } else {
                        alert('‚ùå Fun√ß√£o n√£o dispon√≠vel. Verifique se o sistema est√° carregado.');
                    }
                    break;
                    
                case '2':
                    if (window.clearAllFirebaseData) {
                        window.clearAllFirebaseData();
                    } else {
                        alert('‚ùå Fun√ß√£o n√£o dispon√≠vel. Verifique se o sistema est√° carregado.');
                    }
                    break;
                    
                case '0':
                case null:
                    // Cancelado
                    break;
                    
                default:
                    alert('‚ùå Op√ß√£o inv√°lida. Opera√ß√£o cancelada.');
            }
        }
        
        // Verificar permiss√µes quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                checkAdminPermissions();
            }, 2000);
        });
        
        // Verificar permiss√µes quando mudar de se√ß√£o
        const originalShowSection = showSection;
        showSection = function(sectionName, event) {
            originalShowSection(sectionName, event);
            if (sectionName === 'enderecos') {
                setTimeout(() => {
                    checkAdminPermissions();
                }, 500);
            }
        };

    </script>
</body>
</html>